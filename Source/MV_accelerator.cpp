//==============================================================================
// タイトル     :   モデルビューアー用アクセラレータ処理
// ファイル名   :   MV_accelerator.cpp
// 作成者       :   AT13B284 21 数藤凌哉
// 作成日       :   2016/07/11
//==============================================================================

//==============================================================================
// 更新履歴: -2016/07/11 数藤凌哉
//           ・制作開始
//==============================================================================

//==============================================================================
// WARNING防止
//==============================================================================
#define _CRT_SECURE_NO_WARNINGS

//==============================================================================
// インクルードファイル
//==============================================================================
#include "MV_accelerator.h"
#include "modelViewerProc.h"

//==============================================================================
// ライブラリへのリンク設定
//==============================================================================

//==============================================================================
// 列挙型宣言
//==============================================================================

//==============================================================================
// マクロ定義
//==============================================================================

//==============================================================================
// 構造体宣言
//==============================================================================

//==============================================================================
// プロトタイプ宣言
//==============================================================================

//==============================================================================
// グローバル宣言
//==============================================================================

//==============================================================================
// 静的変数
//==============================================================================

//==============================================================================
// 関数名 : CAccelerator()
// 引数   : void
// 戻り値 : void
// 説明   : デフォルトコンストラクタ
//==============================================================================
CAccelerator::CAccelerator()
{
	m_hAccel = NULL;
}

//==============================================================================
// 関数名 : CAccelerator* Create( HINSTANCE hInstance , WORD id )
// 引数   : HINSTANCE hInstance : インスタンスハンドル
//          WORD id             : 生成対象のID
// 戻り値 : bool型
// 説明   : 初期化処理
//==============================================================================
CAccelerator* CAccelerator::Create( HINSTANCE hInstance , WORD id )
{
	CAccelerator* newInstance = new CAccelerator;

	if( newInstance->Init( hInstance , id ) == false )
	{
		newInstance->Release();
		newInstance = NULL;
	}

	return newInstance;
}

//==============================================================================
// 関数名 : void Release( void )
// 引数   : void
// 戻り値 : void
// 説明   : 解放処理
//==============================================================================
void CAccelerator::Release( void )
{
	delete this;
}

//==============================================================================
// 関数名 : bool Init( HINSTANCE hInstance , WORD id )
// 引数   : HINSTANCE hInstance : インスタンスハンドル
//          WORD id             : 生成対象のID
// 戻り値 : bool型
// 説明   : 初期化処理
//==============================================================================
bool CAccelerator::Init( HINSTANCE hInstance , WORD id )
{
	// アクセラレータ生成
	m_hAccel = LoadAccelerators( hInstance , MAKEINTRESOURCE( id ) );

	return true;
}
